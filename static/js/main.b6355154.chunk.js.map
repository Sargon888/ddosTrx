{"version":3,"sources":["App.js","index.js"],"names":["App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","refreshBalance","asyncToGenerator","regenerator_default","a","mark","_callee","tronWeb","wrap","_context","prev","next","window","t0","state","address","t1","trx","getBalance","t2","sent","t3","balance","setState","stop","gettoken","_callee2","_context2","contract","getToken","send","then","output","console","group","log","tokenBalance","toString","groupEnd","setDefaultBlock","defaultAddress","base58","fromHex","artifact","_react_16_11_0_react_default","createElement","className","onClick","Component","waitForGlobal","_ref","_callee3","nodes","_context3","isConnected","entries","map","_ref2","_ref3","slicedToArray","name","connected","error","concat","includes","ReactDOM","render","src_App_0","document","getElementById","setTimeout","apply","arguments"],"mappings":"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","file":"static/js/main.b6355154.chunk.js","sourcesContent":["import React, {Component} from 'react';\nimport './App.css';\nimport * as artifact from './contracts/Token'\n\n\n\nclass App extends Component {\n\n    constructor(props) {\n        super(props);\n\n        window.tronWeb.setDefaultBlock('latest');\n\n        this.contract = null;\n        this.state = {\n            address : null,\n            balance : null,\n            contract : null,\n            tokenBalance: null,\n        }\n    }\n\n    async componentDidMount() {\n\n        let tronWeb = window.tronWeb;\n        this.setState({address : tronWeb.defaultAddress.base58});\n        let address = tronWeb.address.fromHex(artifact.networks['*'].address);\n        console.log(artifact.abi, artifact.networks['*'].address, address)\n        this.contract = tronWeb.contract(artifact.abi, address);\n        console.log(this.contract)\n        await this.refreshBalance();\n    }\n\n\n    // onClick = async () => {\n    //     let tronWeb = window.tronWeb;\n    //     const sendTransaction = await tronWeb.trx.sendTransaction(\"TKPzfsXRaDmdKh2GuouXw2eyK2HNH9FNQS\", 1000);\n    //     console.log('- Transaction:\\n' + JSON.stringify(sendTransaction, null, 2), '\\n');\n    // };\n\n    refreshBalance = async () => {\n        let tronWeb = window.tronWeb;\n        this.state.address && (this.setState({balance : await tronWeb.trx.getBalance(this.address)}));\n    };\n\n    gettoken = async () => {\n        let tronWeb = window.tronWeb;\n        this.state.address &&  this.contract.getToken().send().then(output => {\n            console.group('Contract \"call\" result');\n            console.log('- Output:', output, '\\n');\n            this.setState({tokenBalance: output.toString()});\n            console.groupEnd();\n        });\n    };\n\n\n    render() {\n        return (\n            <div className=\"App\">\n                <h1>14点开始！提前进去会被退钱</h1>\n                <div>\n                    <p>current address</p>\n                    <p>{this.state.address}</p>\n                    <hr></hr>\n                </div>\n\n                    <p>current trx balance</p>\n                    <p>{this.state.balance/1e6}</p>\n                    <button onClick={this.refreshBalance}>Refresh balance</button>\n                    <hr></hr>\n                <div>\n                </div>\n                    <p>get token</p>\n                    {/* <p>{this.state.tokenBalance}</p> */}\n                    <button onClick={this.gettoken}>薅</button>\n                    <hr></hr>\n                \n                \n            </div>\n        );\n    }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nvar waitForGlobal = async () =>{\n    // 1. check variable, 检查tronweb是否已经加载\n    if (window.tronWeb) {\n        let tronWeb = window.tronWeb;\n        // 2. check node connection，检查所需要的API是否都可以连通\n        const nodes = await tronWeb.isConnected();\n        const connected = !Object.entries(nodes).map(([name, connected]) => {\n            if (!connected) {\n                console.error(`Error: ${name} is not connected`);\n            }\n            return connected;\n        }).includes(false);\n        if (connected){\n            // 3. 如果一切正常，启动react应用。\n            ReactDOM.render(<App />, document.getElementById('root'));\n        } else {\n            console.error(`Error: TRON node is not connected`);\n            console.error('wait for tronLink');\n            setTimeout(async () => {\n                await waitForGlobal();\n            }, 100);\n        }\n\n    } else {\n        // 如果检测到没有注入tronWeb对象，则等待100ms后重新检测\n        console.error('wait for tronLink');\n        setTimeout(async () => {\n            await waitForGlobal();\n        }, 100);\n    }\n};\n\nwaitForGlobal().then();\n\n"],"sourceRoot":""}